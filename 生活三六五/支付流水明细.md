
```sql

-- 修改pay_message表
ALTER TABLE pay_message CHANGE ORDER_ID OUT_TRADE_NO varchar(64) NOT NULL COMMENT '上游交易订单ID';
ALTER TABLE pay_message CHANGE third_party_id CHANNEL_TRADE_NO varchar(64) DEFAULT NULL COMMENT '第三方通道交易单号';
ALTER TABLE pay_message DROP FAKE_ID;
ALTER TABLE pay_message DROP SOURCE;
ALTER TABLE pay_message DROP NOTIFY_URL;
ALTER TABLE pay_message DROP payment_id;
ALTER TABLE pay_message ADD COLUMN `TRADE_TIME` timestamp NULL DEFAULT NULL COMMENT '交易时间' AFTER CHANNEL_TRADE_NO;
ALTER TABLE pay_message ADD COLUMN `CHANNEL` varchar(64) NOT NULL COMMENT '支付通道' AFTER PAYMENT_TYPE;

ALTER TABLE pay_message ADD INDEX `CHANNEL_TRADE_NO_INDEX` (`CHANNEL_TRADE_NO`) USING BTREE;

-- 修改notify_message表
ALTER TABLE notify_message DROP ORDER_ID;
ALTER TABLE notify_message DROP FAKE_ID;
ALTER TABLE notify_message DROP PAYMENT_TYPE;
ALTER TABLE notify_message DROP payment_id;


-- 支付收款关联表
CREATE TABLE `pay_detail` (
  `pay_id` varchar(20) NOT NULL COMMENT 'pay_message表的id',
  `channel_app_id` varchar(64) NOT NULL COMMENT '支付通道账号ID，如微信app_id', -- 新加的
  `unfrozen_time` timestamp NULL DEFAULT NULL COMMENT '解冻时间',             -- 新加的
  `create_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `modify_date` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`pay_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='支付流水关联表';

-- 退款关联
CREATE TABLE `refund_detail` (
  `refund_id` varchar(20) NOT NULL COMMENT 'pay_message表的id',
  `pay_message_id` varchar(30) NOT NULL COMMENT '要退款的支付流水ID',
  `create_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `modify_date` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`refund_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='退款流水关联表';

-- 提现流水关联
CREATE TABLE `withdrawal_detail` (
  `withdrawal_id` varchar(20) NOT NULL COMMENT 'pay_message表的id',
  `account_flow_id` varchar(30) NOT NULL COMMENT 'account_flow表的ID',
  `create_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `modify_date` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`withdrawal_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='提现流水关联表';

-- 连连账户交易记录（分账明细表）-- 账户资金组成
CREATE TABLE `account_flow` (
  `flow_id` varchar(20) NOT NULL COMMENT '资金流ID',
  `root_id` varchar(20) NOT NULL COMMENT '资金流ID（根）',
  `parent_id` varchar(20) NOT NULL COMMENT '资金流ID（父）,若没有的话保存‘0’',
  `account_id` varchar(20) NOT NULL COMMENT '账户ID',
  `trade_message_id` varchar(20) NOT NULL COMMENT '订单消息记录ID',
  `amount` int(10) NOT NULL COMMENT '交易金额，单位：分',
  `status` varchar(20) NOT NULL COMMENT '资金流状态',
  `del_flag` varchar(1) DEFAULT '1' COMMENT '逻辑删除 （1 正常 0删除）',
  `create_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `modify_date` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`flow_id`),
  KEY `account_id_index` (`account_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='账户资金流向（组成）表';

-- 账户资金变动日志
CREATE TABLE `account_flow_log` (
  `log_id` varchar(20) NOT NULL COMMENT '资金流ID',
  `parent_flow_id` varchar(20) NOT NULL COMMENT '父资金流ID',
  `children_flow_id` varchar(255) NOT NULL COMMENT '子资金流ID',
  `type` varchar(20) NOT NULL COMMENT '资金流状态',
  `content` varchar(1000) NOT NULL COMMENT '资金流变动内容',
  `del_flag` varchar(1) DEFAULT '1' COMMENT '逻辑删除 （1 正常 0删除）',
  `create_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `modify_date` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`log_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='账户资金流变动日志表';

```